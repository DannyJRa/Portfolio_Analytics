---
title: "Untitled"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and Microsoft Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **R Tools | Publish | Preview** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
summary(cars)
```

```{r}
library(googleway)

api_key <- "AIzaSyBzaG80oBtS4WShTNj13cWQJ9kJI9RF4LA"
map_key <- "AIzaSyBzaG80oBtS4WShTNj13cWQJ9kJI9RF4LA"

```


```{r, echo=FALSE}

## set up a data.frame of locations
## can also use 'lat/lon' coordinates as the origin/destination
df_locations <- data.frame(origin = c("Melbourne, Australia", "Sydney, Australia"),
                           destination = c("Sydney, Australia", "Brisbane, Australia"),
                           stringsAsFactors = F)


## loop over each pair of locations, and extract the polyline from the result
lst_directions <- apply(df_locations, 1, function(x){
  res <- google_directions(key = api_key,
                           origin = x[['origin']],
                           destination = x[['destination']])

  df_result <- data.frame(origin = x[['origin']],
                          destination = x[['destination']],
                          route = res$routes$overview_polyline$points)
  return(df_result)

})

## convert the results to a data.frame
df_directions <- do.call(rbind, lst_directions)

## plot the map
google_map(key = map_key ) %>%
  add_polylines(data = df_directions, polyline = "route")
  
```